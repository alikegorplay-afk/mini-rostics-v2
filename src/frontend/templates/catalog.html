{% extends "base.html" %}

{% block content %}
<link rel="stylesheet" href="/static/catalog-styles.css">
<link rel="stylesheet" href="/static/modal-style.css">
<link rel="stylesheet" href="/static/case.css">
<link rel="stylesheet" href="/static/qr-code.css">
<script type="text/javascript" src="/static/model.js"></script>

<style>
.modal-hear {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8);
    justify-content: center;
    align-items: center;
    z-index: 1000;
}
.modal-hear-content {
    background: white;
    padding: 30px;
    border-radius: 10px;
    text-align: center;
    max-width: 400px;
}
#countdown {
    font-weight: bold;
    color: red;
}
button {
    padding: 10px 20px;
    margin-top: 15px;
    cursor: pointer;
}
</style>

<div id="inactiveModal" class="modal-hear">
    <div class="modal-hear-content">
        <h2>–í—ã —Ç—É—Ç?</h2>
        <p>–°–µ—Å—Å–∏—è –±—É–¥–µ—Ç —Å–±—Ä–æ—à–µ–Ω–∞ —á–µ—Ä–µ–∑ <span id="countdown">10</span> —Å–µ–∫—É–Ω–¥</p>
        <button id="stayActive">–î–∞, —è –∑–¥–µ—Å—å!</button>
    </div>
</div>

<div class="catalog-h1">
    <h1>–ù–∞—à –∫–∞—Ç–∞–ª–æ–≥</h1>
</div>
<div class="catalog-container">
    
    <div class="catalog-grid">
        {% for product in products %}
        <div class="product-card" 
            data-product-id="{{ product.id }}" 
            data-product-name="{{ product.title }}" 
            data-product-price="{{ product.price }}" 
            data-product-image="{{ product.poster }}" 
            data-product-description="{{ product.description }}"
            data-product-count="{{ product.count }}">
            <div class="product-image">
                <img src="{{ product.poster }}" alt="{{ product.title }}">
                {% if product.count == 0 %}
                <div class="out-of-stock-badge">–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏</div>
                {% endif %}
            </div>
            <div class="product-info">
                <h3 class="product-title">{{ product.title }}</h3>
                <div class="product-price">
                    <span class="current-price">{{ product.price }} —Ä—É–±.</span>
                </div>
                <div class="product-meta">
                    {% if product.count > 0 %}
                        <div class="in-stock">–í –Ω–∞–ª–∏—á–∏–∏</div>
                    {% else %}
                        <div class="out-of-stock">–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç</div>
                    {% endif %}
                </div>
                {% if product.description[:100] == product.description %}
                    <p class="product-description">{{ product.description }}</p>
                {% else %}
                    <p class="product-description">{{ product.description[:100] }}...</p>
                {% endif %}
                
                <!-- –î–æ–±–∞–≤–ª–µ–Ω–Ω–∞—è –∫–Ω–æ–ø–∫–∞ –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ -->
                <button class="quick-view-btn" type="button">
                    <span class="quick-view-icon"></span>
                    –ë—ã—Å—Ç—Ä—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä
                </button>
            </div>
        </div>
        {% endfor %}
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ -->
<div id="productModal" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>
        
        <div class="modal-product">
            <div class="modal-image">
                <img id="modalProductImage" src="" alt="">
                <div class="out-of-stock-badge" id="modalOutOfStock" style="display: none;">–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏</div>
            </div>
            
            <div class="modal-info">
                <div class="modal-header">
                    <h2 id="modalProductName"></h2>
                    <div class="modal-price-section">
                        <span id="modalProductPrice" class="modal-price"></span>
                        <span class="modal-currency">—Ä—É–±.</span>
                    </div>
                </div>
                
                <p class="modal-description" id="modalProductDescription"></p>
                
                <div class="stock-info">
                    <span id="modalStockStatus"></span>
                </div>
                
                <div class="quantity-selector">
                    <span>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ:</span>
                    <div class="quantity-controls">
                        <button class="quantity-btn minus" type="button">-</button>
                        <span class="quantity">1</span>
                        <button class="quantity-btn plus" type="button">+</button>
                    </div>
                </div>
                
                <div class="modal-actions">
                    <button class="add-to-cart-modal" id="modalAddToCart" type="button">
                        –î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É - <span id="modalTotalPrice"></span> —Ä—É–±.
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- –í–∏–¥–∂–µ—Ç –∫–æ—Ä–∑–∏–Ω—ã -->
<div class="cart-widget" id="cartWidget">
    <div class="cart-icon">
        üõí
        <span class="cart-count" id="cartCount">0</span>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∫–æ—Ä–∑–∏–Ω—ã -->
<div id="cartModal" class="cart-modal">
    <div class="cart-modal-content">
        <div class="cart-modal-header">
            <h2>–í–∞—à –∑–∞–∫–∞–∑</h2>
            <span class="cart-close">&times;</span>
        </div>
        
        <div class="cart-items" id="cartItems">
            <!-- –¢–æ–≤–∞—Ä—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            <div class="empty-cart" id="emptyCart">
                <p>–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</p>
            </div>
        </div>
        
        <div class="cart-summary">
            <div class="cart-total">
                <span>–ò—Ç–æ–≥–æ:</span>
                <span id="cartTotalPrice">0 —Ä—É–±.</span>
            </div>
            
            <div class="cart-actions">
                <button class="order-btn" id="orderBtn">
                    <span class="order-btn-text">–ó–∞–∫–∞–∑–∞—Ç—å</span>
                    <span class="order-btn-icon">üöÄ</span>
                </button>
            </div>
        </div>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å QR –∫–æ–¥–æ–º -->
<div id="qrModal" class="qr-modal">
    <div class="qr-modal-content">
        <div class="qr-modal-header">
            <h2>–ó–∞–∫–∞–∑ —É—Å–ø–µ—à–Ω–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω! üéâ</h2>
            <span class="qr-close">&times;</span>
        </div>
        
        <div class="qr-modal-body">
            <div class="qr-code-container">
                <img id="qrCodeImage" src="" alt="QR Code" class="qr-code">
                <div class="qr-loading" id="qrLoading">–ì–µ–Ω–µ—Ä–∞—Ü–∏—è QR –∫–æ–¥–∞...</div>
            </div>
            
            <div class="order-success-info">
                <p>–í–∞—à –∑–∞–∫–∞–∑ –ø—Ä–∏–Ω—è—Ç –≤ –æ–±—Ä–∞–±–æ—Ç–∫—É</p>
                <p class="order-number">–ù–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞: <span id="orderNumber">-</span></p>
                <p class="order-total">–°—É–º–º–∞: <span id="orderTotalAmount">0</span> —Ä—É–±.</p>
            </div>
            
            <div class="qr-actions">
                <button class="qr-close-btn" id="qrCloseBtn">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>
</div>


<script type="text/javascript" src="/static/case.js"></script>
<script type="text/javascript" src="/static/youhear.js"></script>

{% endblock %}